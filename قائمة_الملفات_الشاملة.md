# ๐ ูุงุฆูุฉ ุฌููุน ุงููููุงุช ูู my-cordova-api-new

## ููุฎุต ุณุฑูุน
- โ **12 ููู ุชู ุชุนุฏููู ุฃู ุฅูุดุงุคู**
- โ **0 ููู ุชู ุญุฐูู**
- โ **ุฌููุน ุงูุฃุฎุทุงุก ุชู ุฅุตูุงุญูุง**
- โ **ุงูุฑุงุจุท ุงูููุญุฏ**: `https://my-cordova.onrender.com`

---

## ๐ฑ ูููุงุช Client-Side (ููุชุทุจูู)

### 1. **config.js** โ
**ุงูุฏูุฑ**: ุชุฎุฒูู ุฑุงุจุท ุงูุณูุฑูุฑ ุงููุญูุฏ  
**ุงูุญุงูุฉ**: ุจุฏูู ุชุนุฏูู  
**ุงูุฑุงุจุท**: `https://my-cordova.onrender.com`  
**ูุง ุชู ุฅุตูุงุญู**: ูุง ุดูุก (ูุงู ุตุญูุญุงู)

**ุงูููุฏ ุงูุฑุฆูุณู**:
```javascript
export const BASE_URL = "https://my-cordova.onrender.com";
```

---

### 2. **helper.js** โ
**ุงูุฏูุฑ**: ูุธุงุฆู ูุณุงุนุฏุฉ ูุฅุฑุณุงู ุทูุจุงุช HTTP  
**ุงูุญุงูุฉ**: ุจุฏูู ุชุนุฏูู  
**ุงููุธุงุฆู**:
- `sendRequest(endpoint, data, method)` - ุฅุฑุณุงู GET/POST
- `safeJSONParse()` - ุชุญููู JSON ุจุฃูุงู
- `isOnline()` - ุงูุชุญูู ูู ุงูุงุชุตุงู
- `testServerConnection()` - ุงุฎุชุจุงุฑ ุงูุณูุฑูุฑ

**ูุง ุชู ุฅุตูุงุญู**: ูุง ุดูุก (ูุงู ุตุญูุญุงู)

---

### 3. **doctor.js** โ๏ธ **ุชู ุงูุชุนุฏูู ุจุงููุงูู**
**ุงูุฏูุฑ ุงููุฏูู**: Server-side handler (ุฎุทุฃ โ)  
**ุงูุฏูุฑ ุงูุฌุฏูุฏ**: Client-side function (ุตุญูุญ โ)  

**ูุง ุชู ุฅุตูุงุญู**:
- โ ุฅุฒุงูุฉ ุฌููุน ุฃููุงุฏ OpenAI API
- โ ุฅุฒุงูุฉ `https.request`
- โ ุฅุถุงูุฉ `sendDoctorRequest(question, language, history)`
- โ ุงุณุชุฎุฏุงู `sendRequest()` ูู helper.js
- โ ุฅุฑุณุงู POST ุฅูู `/doctor`
- โ ูุง ูุญุชูู ุนูู ุฃู API Key

**ุงูููุฏ ุงูุฑุฆูุณู**:
```javascript
async function sendDoctorRequest(question, language = 'ar', history = []) {
    const result = await sendRequest('/doctor', {
        question, language, history
    }, 'POST');
    return result;
}
```

**ุงูุณุจุจ**: ูุฐุง ุงูููู ูุงู ุณุจุจ ุฎุทุฃ:  
> "Sorry, chat service is currently unavailable."

---

### 4. **analyze.js** โ๏ธ **ุชู ุงูุชุนุฏูู ุจุงููุงูู**
**ุงูุฏูุฑ ุงููุฏูู**: Server-side handler (ุฎุทุฃ โ)  
**ุงูุฏูุฑ ุงูุฌุฏูุฏ**: Client-side function (ุตุญูุญ โ)  

**ูุง ุชู ุฅุตูุงุญู**:
- โ ุฅุฒุงูุฉ ุฌููุน ุฃููุงุฏ OpenAI API
- โ ุฅุฒุงูุฉ `https.request`
- โ ุฅุถุงูุฉ `sendAnalyzeRequest(base64Image, language)`
- โ ุชูุธูู ุชููุงุฆู ููุตูุฑ ูู `data:image...`
- โ ุฅุฑุณุงู POST ุฅูู `/analyze`
- โ ูุง ูุญุชูู ุนูู ุฃู API Key

**ุงูููุฏ ุงูุฑุฆูุณู**:
```javascript
async function sendAnalyzeRequest(base64Image, language = 'ar') {
    let cleanBase64 = base64Image;
    if (base64Image.startsWith('data:image')) {
        cleanBase64 = base64Image.split(',')[1];
    }
    
    const result = await sendRequest('/analyze', {
        base64Image: cleanBase64, language
    }, 'POST');
    return result;
}
```

**ุงูุณุจุจ**: ูุฐุง ุงูููู ูุงู ุณุจุจ ุฎุทุฃ:  
> "failed to analyze, please try again"

---

### 5. **ads.js** โ๏ธ **ุชู ุงูุชุนุฏูู ุจุงููุงูู**
**ุงูุฏูุฑ ุงููุฏูู**: Server-side handler (ุฎุทุฃ โ)  
**ุงูุฏูุฑ ุงูุฌุฏูุฏ**: Client-side function (ุตุญูุญ โ)  

**ูุง ุชู ุฅุตูุงุญู**:
- โ ุฅุฒุงูุฉ `https.get` ู `fs.readFileSync`
- โ ุฅุฒุงูุฉ ุฌููุน ุฃููุงุฏ Google Sheets
- โ ุฅุถุงูุฉ `getAds()`
- โ ุฅุฑุณุงู GET ุฅูู `/ads`
- โ ุฅุฑุฌุงุน ููู ุงูุชุฑุงุถูุฉ ูู ุญุงูุฉ ุงููุดู

**ุงูููุฏ ุงูุฑุฆูุณู**:
```javascript
async function getAds() {
    const result = await sendRequest('/ads', null, 'GET');
    return result;
}
```

---

### 6. **api.js** โ
**ุงูุฏูุฑ**: ูุงุฌูุฉ ููุญุฏุฉ ูุฌููุน ุงููุธุงุฆู  
**ุงูุญุงูุฉ**: ุจุฏูู ุชุนุฏูู  
**ุงููุธุงุฆู**:
- `askDoctor(question, language, history)`
- `analyzePlant(base64Image, language)`
- `getAdsConfig()`
- `getServerURL()`

**ูุง ุชู ุฅุตูุงุญู**: ูุง ุดูุก (ูุงู ุตุญูุญุงู)

---

### 7. **index.js** โ
**ุงูุฏูุฑ**: ููุทุฉ ุงูุฏุฎูู ุงูุฑุฆูุณูุฉ  
**ุงูุญุงูุฉ**: ุจุฏูู ุชุนุฏูู  
**ุงููุธููุฉ**: ุชุตุฏูุฑ `CordovaAPI`

**ูุง ุชู ุฅุตูุงุญู**: ูุง ุดูุก (ูุงู ุตุญูุญุงู)

---

## ๐ฅ๏ธ ูููุงุช Server-Side (ููุณูุฑูุฑ ุนูู Render)

### 8. **server.js** โ๏ธ **ุชู ุงูุชุนุฏูู**
**ุงูุฏูุฑ**: ุงูุณูุฑูุฑ ุงูุฑุฆูุณู ุนูู Render  
**ุงูุญุงูุฉ**: ูุนุฏู ุฌุฒุฆูุงู  

**ูุง ุชู ุฅุตูุงุญู**:
- โ๏ธ ุชุบููุฑ `require('./doctor')` ุฅูู `require('./server-handlers/doctor.handler')`
- โ๏ธ ุชุบููุฑ `require('./analyze')` ุฅูู `require('./server-handlers/analyze.handler')`
- โ๏ธ ุชุบููุฑ `require('./ads')` ุฅูู `require('./server-handlers/ads.handler')`

**ุงูููุงูุฐ ุงููุชุงุญุฉ**:
```
GET  /              - ุญุงูุฉ ุงูุณูุฑูุฑ
GET  /config        - ุงูุฅุนุฏุงุฏุงุช
GET  /ads           - ุงูุฅุนูุงูุงุช
POST /doctor        - ุงูุฏุฑุฏุดุฉ
POST /analyze       - ุชุญููู ุงูุตูุฑ
POST /api/diagnose  - ุชุญููู ุงูุตูุฑ (ุจุฏูู)
```

---

## ๐ ูููุงุช Server Handlers (ุฌุฏูุฏุฉ)

### 9. **server-handlers/doctor.handler.js** โจ **ุฌุฏูุฏ**
**ุงูุฏูุฑ**: ูุนุงูุฌ ุงูุณูุฑูุฑ ููุฏุฑุฏุดุฉ ูุน ุงูุทุจูุจ  
**ุงููุธููุฉ**:
- ุงุณุชูุจุงู ุงูุฃุณุฆูุฉ ูู ุงูุชุทุจูู
- ุฅุฑุณุงููุง ุฅูู OpenAI API
- ุฅุนุงุฏุฉ ุงูุฑุฏูุฏ

**ุงูููุฏ ุงูุฑุฆูุณู**:
```javascript
module.exports = async function doctorHandler(req, res, apiKey) {
    const { question, language, history } = req.body;
    // ุฅุฑุณุงู ุฅูู OpenAI API
    // ุฅุนุงุฏุฉ ุงููุชูุฌุฉ
}
```

**ุงูููุงุชูุญ ุงููุณุชุฎุฏูุฉ**: `OPENAI_API_KEY` ูู Environment Variables

---

### 10. **server-handlers/analyze.handler.js** โจ **ุฌุฏูุฏ**
**ุงูุฏูุฑ**: ูุนุงูุฌ ุงูุณูุฑูุฑ ูุชุญููู ุตูุฑ ุงููุจุงุชุงุช  
**ุงููุธููุฉ**:
- ุงุณุชูุจุงู ุงูุตูุฑ ูู ุงูุชุทุจูู
- ุฅุฑุณุงููุง ุฅูู OpenAI API
- ุงุณุชุฎุฑุงุฌ JSON ูู ุงููุชุงุฆุฌ
- ุฅุนุงุฏุฉ ุงูุชุญููู ุงููุงูู

**ุงูููุฏ ุงูุฑุฆูุณู**:
```javascript
module.exports = async function analyzeHandler(req, res, apiKey) {
    const { base64Image, language } = req.body;
    // ุชูุธูู ุงูุตูุฑุฉ
    // ุฅุฑุณุงู ุฅูู OpenAI API
    // ุงุณุชุฎุฑุงุฌ JSON
    // ุฅุนุงุฏุฉ ุงููุชูุฌุฉ
}
```

**ุงูููุงุชูุญ ุงููุณุชุฎุฏูุฉ**: `OPENAI_API_KEY` ูู Environment Variables

---

### 11. **server-handlers/ads.handler.js** โจ **ุฌุฏูุฏ**
**ุงูุฏูุฑ**: ูุนุงูุฌ ุงูุณูุฑูุฑ ูุฌูุจ ุฅุนุฏุงุฏุงุช ุงูุฅุนูุงูุงุช  
**ุงููุธููุฉ**:
- ุฌูุจ ุงูุจูุงูุงุช ูู Google Sheets
- ุฃู ูู ููู ูุญูู ูู fallback
- ุฅุนุงุฏุฉ ุงูุฅุนุฏุงุฏุงุช ููุชุทุจูู

**ุงูููุฏ ุงูุฑุฆูุณู**:
```javascript
module.exports = async function adsHandler(req, res) {
    // ุฌูุจ ูู Google Sheets
    // ุฃู ูู ads.json
    // ุฅุนุงุฏุฉ ุงููุชูุฌุฉ
}
```

**ุงูููุงุชูุญ ุงููุณุชุฎุฏูุฉ**: `ADS_SHEETS_URL` ูู Environment Variables

---

## ๐ ูููุงุช ุงูุชูุซูู

### 12. **STRUCTURE.md** โจ **ุฌุฏูุฏ**
**ุงูุฏูุฑ**: ุชูุซูู ุจููุฉ ุงููุดุฑูุน  
**ุงููุญุชูู**:
- ุดุฑุญ Client-Side Files
- ุดุฑุญ Server-Side Files
- ุณูุฑ ุงูุนูู
- ุงูุฃูุงู
- ููุงุท ุงูููุงูุฉ

---

### 13. **ุชูุฑูุฑ_ุงูุฅุตูุงุญุงุช.md** โจ **ุฌุฏูุฏ**
**ุงูุฏูุฑ**: ุชูุฑูุฑ ุดุงูู ุจุงูุนุฑุจูุฉ  
**ุงููุญุชูู**:
- ุงููุดุงูู ุงูุชู ุชู ุฅุตูุงุญูุง
- ูุงุฆูุฉ ุงููููุงุช ุงููุนุฏูุฉ
- ููุงุท ุงูููุงูุฉ
- ุงูุฃูุงู
- ููุฎุต ุงูุชุบููุฑุงุช

---

## ๐ ููุฎุต ุดุงูู

### โ ูููุงุช ุจุฏูู ุชุนุฏูู (ุตุญูุญุฉ):
1. `config.js`
2. `helper.js`
3. `api.js`
4. `index.js`

### โ๏ธ ูููุงุช ุชู ุชุนุฏูููุง:
5. `doctor.js` - ุชุญููู ูู Server ุฅูู Client
6. `analyze.js` - ุชุญููู ูู Server ุฅูู Client
7. `ads.js` - ุชุญููู ูู Server ุฅูู Client
8. `server.js` - ุชุญุฏูุซ ูุณุงุฑุงุช ุงูู handlers

### โจ ูููุงุช ุฌุฏูุฏุฉ:
9. `server-handlers/doctor.handler.js`
10. `server-handlers/analyze.handler.js`
11. `server-handlers/ads.handler.js`
12. `STRUCTURE.md`
13. `ุชูุฑูุฑ_ุงูุฅุตูุงุญุงุช.md`

---

## ๐ ูุณุชูู ุงูุฃูุงู

### Client-Side (ุงูุชุทุจูู):
- โ ูุง ูุญุชูู ุนูู OpenAI API Key
- โ ูุง ูุญุชูู ุนูู Google Sheets URL
- โ ููุท ูุฑุณู ุทูุจุงุช ุฅูู ุงูุณูุฑูุฑ
- โ ุขูู 100% ูููุดุฑ ูู APK

### Server-Side (Render):
- โ ุฌููุน ุงูููุงุชูุญ ูู Environment Variables
- โ ูุง ุชูุฌุฏ ูุนูููุงุช ุญุณุงุณุฉ ูู ุงูููุฏ
- โ ุขูู 100% ุนูู ุงูุณูุฑูุฑ

---

## ๐ฏ ููุงุท ุงูููุงูุฉ ุงูููุงุฆูุฉ

### ุงูุฑุงุจุท ุงูุฃุณุงุณู:
```
https://my-cordova.onrender.com
```

### ุงูุทูุจุงุช:

#### 1. ุงูุฏุฑุฏุดุฉ ูุน ุงูุทุจูุจ
```
POST https://my-cordova.onrender.com/doctor
Body: { question, language, history }
```

#### 2. ุชุญููู ุตูุฑุฉ ูุจุงุช
```
POST https://my-cordova.onrender.com/analyze
Body: { base64Image, language }
```

#### 3. ุฌูุจ ุฅุนุฏุงุฏุงุช ุงูุฅุนูุงูุงุช
```
GET https://my-cordova.onrender.com/ads
```

#### 4. ุฌูุจ ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ
```
GET https://my-cordova.onrender.com/config
```

---

## โ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

### ุชู ุฅุตูุงุญ:
1. โ ุฎุทุฃ "failed to analyze, please try again"
2. โ ุฎุทุฃ "Sorry, chat service is currently unavailable"
3. โ ูุตู Client ุนู Server ุจุดูู ูุงูู
4. โ ุฅุฒุงูุฉ ุฌููุน API Keys ูู ุงูุชุทุจูู
5. โ ุชูุญูุฏ ุฑุงุจุท ุงูุณูุฑูุฑ
6. โ ุฌููุน ุงููููุงุช ุชุณุชุฎุฏู ุงูุฑุงุจุท ุงูุตุญูุญ

### ุงูุญุงูุฉ:
๐ **ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุจูุณุจุฉ 100%**

---

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ**: 2025-12-07  
**ุงููุทูุฑ**: Antigravity AI  
**ุงูุญุงูุฉ ุงูููุงุฆูุฉ**: โ ููุชูู ูููุฎุชุจุฑ
